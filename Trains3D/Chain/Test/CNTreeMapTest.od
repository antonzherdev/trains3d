import CNTest
import CNTreeMap

class CNTreeMapTest extends CNTestCase {
    def testMain {
        val map = CNMutableTreeMap.new<int, string>
        assertEquals(0, map.count)
        assertTrue(map[0].isEmpty)

        map.set(object = "test", forKey = 0)
        assertEquals("test", map[0].get)

        val tests : [int] = [-10, -20, -30, 10, 20, -15, 20, 0, 11, 13, -18]
        tests.for(i -> map.set(object = "test" + i, forKey = i))
        assertEquals(tests.chain.distinct.count, map.count)
        tests.chain.distinct.for(i -> assertEquals("test" + i, map[i].get))

        assertEquals([-30, -20, -18, -15, -10, 0, 10, 11, 13, 20], map.keys.chain.toArray)

        tests.chain.distinct.for(i -> {
            assertEquals("test" + i, map[i].get)
            map.removeFor(key = i)
            assertTrue(map[i].isEmpty)
        })
        assertEquals(0, map.count)
    }
}