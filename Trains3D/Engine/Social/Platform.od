package com.antonzherdev.eg

enum OSType(shadows : bool, touch : bool) {
    MacOS(true, false)
    iOS(true, true)
}

enum InterfaceIdiom(isPhone : bool, isPad : bool, isComputer : bool) {
    phone(true, false, false)
    pad(false, true, false)
    computer(false, false, true)
}

class Platform(os : OSType, interfaceIdiom : InterfaceIdiom, version : Version, screenSize : vec2, jailbreak : bool, text : string) {
    val shadows = os.shadows
    val touch = os.touch

    val isPhone = interfaceIdiom.isPhone
    val isPad = interfaceIdiom.isPad
    val isComputer = interfaceIdiom.isComputer

    def screenSizeRatio : float = screenSize.x/screenSize.y

    def isIOS = os == OSType.iOS
    def isIOSLess(version : string) = os == OSType.iOS && self.version.less(version)
}


class Version(parts : [int]) extends Comparable<Version> {
    static def apply(str : string) : Version = Version(str.split(".").chain.map(_.toInt).toArray)

    def compare(to : Version) : int = {
        val i = parts.iterator
        val j = to.parts.iterator
        while(i.hasNext && j.hasNext) {
            val vi = i.next
            val vj = j.next
            if(vi != vj) {
                return vi.compare(vj)
            }
        }
        0
    }

    def less(than : string) : bool = compare(Version(str = than)) < 0
    def more(than : string) : bool = compare(Version(str = than)) > 0
}